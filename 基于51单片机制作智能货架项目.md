# 基于51单片机制作<智能货架>项目

```c
#define uint unsigned int
#define uchar unsigned char

#define wela XBYTE[0xfeff]
#define dela XBYTE[0xfdff]
#define PA XBYTE[0x1fff]
#define PB XBYTE[0x3fff]
#define PC XBYTE[0x5fff]
#define COM XBYTE[0x7fff]//CS--P2^7; A1=P2^6; A0=P2^5;
#define left {hand_left=1;hand_right=0;}
#define right {hand_left=0;hand_right=1;}
#define stop {hand_left=1;hand_right=1;}
#define loose hand_close_loose=1
#define close hand_close_loose=0
#define up hand_up_down=1
#define down hand_up_down=0
#define yigw while(PA&0x01)
#define ergw while(PA&0x02)
#define sangw while(PA&0x04)
#define ss_jc while(PA&0x08) //上升检测
#define xj_jc while(PA&0x10) //下降检测
#define jj_jc while(PA&0x20) //加紧检测
#define yw_jc while(PA&0x40) //有无检测
#define yigw_wl_jc while(PA&0x80)
#define ergw_wl_jc while(PB&0x80)

sbit hand_left=P1^0;
sbit hand_right=P1^1;
sbit hand_close_loose=P1^2;
sbit hand_up_down=P1^3;
sbit cp=P1^4;
sbit dir=P1^5;
sbit rl=P1^6;
sbit rs=P3^0;
sbit en=P3^1;
sbit cs1=P3^2;
sbit cs2=P3^3;
void delay(uint z)
{
	uint x,y;
	for(x=z;x>0;x--)
		for(y=220;y>0;y--);
}
uchar index=0;
wei=0xfe;
uchar dis_buf[8];
uchar code table[]={
		0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90,0x88,0x83,0xc6,0xa1,0x86,0x8e,0xc1,0xff
};
uint wul[]={
	0,1,1,1,1,0,0,0,0
};
uchar code table1[][32]={
/*--  调入了一幅图像：这是您新建的图像  --*/
/*--  宽度x高度=16x16  --*/
0x00,0xF0,0x10,0x10,0x10,0x10,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xC0,0xC3,0xC2,0xC2,0xC2,0xC2,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,

		/*--  文字:  智  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=16x16   --*/
0x10,0x14,0x13,0x92,0x7E,0x32,0x52,0x92,0x00,0x7C,0x44,0x44,0x44,0x7C,0x00,0x00,
0x00,0x01,0x01,0x00,0xFF,0x49,0x49,0x49,0x49,0x49,0x49,0xFF,0x00,0x00,0x00,0x00,

/*--  文字:  能  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=16x16   --*/
0x10,0xB8,0x97,0x92,0x90,0x94,0xB8,0x10,0x00,0x7F,0x48,0x48,0x44,0x74,0x20,0x00,
0x00,0xFF,0x0A,0x0A,0x4A,0x8A,0x7F,0x00,0x00,0x3F,0x44,0x44,0x42,0x72,0x20,0x00,

/*--  文字:  货  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=16x16   --*/
0x00,0x10,0x08,0xBC,0x87,0x82,0x88,0x88,0x9F,0xA4,0xA4,0xA4,0x22,0x32,0x00,0x00,
0x00,0x00,0x80,0x9F,0x40,0x20,0x10,0x0E,0x10,0x20,0x60,0xCF,0x40,0x00,0x00,0x00,

/*--  文字:  架  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=16x16   --*/
0x00,0x84,0x84,0x64,0x1F,0x44,0x84,0x7C,0x00,0x7C,0x44,0x44,0x44,0x7C,0x00,0x00,
0x40,0x42,0x22,0x22,0x12,0x0A,0x06,0xFF,0x06,0x0A,0x12,0x12,0x22,0x62,0x20,0x00,

/*--  文字:  停  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=16x16   --*/
0x80,0x40,0x20,0xF8,0x07,0x02,0x04,0x74,0x54,0x55,0x56,0x54,0x74,0x04,0x04,0x00,
0x00,0x00,0x00,0xFF,0x00,0x03,0x01,0x05,0x45,0x85,0x7D,0x05,0x05,0x05,0x03,0x00,

/*--  文字:  止  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=16x16   --*/
0x00,0x00,0x00,0x00,0xF0,0x00,0x00,0x00,0xFF,0x40,0x40,0x40,0x40,0x40,0x00,0x00,
0x40,0x40,0x40,0x40,0x7F,0x40,0x40,0x40,0x7F,0x40,0x40,0x40,0x40,0x40,0x40,0x00,

/*--  文字:  编  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=16x16   --*/
0x20,0x30,0xAC,0x63,0x32,0x00,0xFC,0xA4,0xA5,0xA6,0xA4,0xA4,0xA4,0xBC,0x00,0x00,
0x10,0x11,0x09,0x49,0x21,0x1C,0x03,0x7F,0x04,0x3F,0x04,0x3F,0x44,0x7F,0x00,0x00,

/*--  文字:  号  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=16x16   --*/
0x40,0x40,0x40,0x5F,0xD1,0x51,0x51,0x51,0x51,0x51,0x51,0x5F,0x40,0x40,0x40,0x00,
0x00,0x00,0x00,0x02,0x07,0x02,0x02,0x22,0x42,0x82,0x42,0x3E,0x00,0x00,0x00,0x00,

/*--  文字:  取  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=16x16   --*/
0x02,0x02,0xFE,0x92,0x92,0x92,0xFE,0x02,0x02,0x7C,0x84,0x04,0x84,0x7C,0x04,0x00,
0x10,0x10,0x0F,0x08,0x08,0x04,0xFF,0x04,0x22,0x10,0x09,0x06,0x09,0x30,0x10,0x00,

/*--  文字:  料  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=16x16   --*/
0x20,0x24,0xA8,0x70,0xFF,0x68,0xA4,0x20,0x42,0x8C,0x00,0x00,0xFF,0x00,0x00,0x00,
0x08,0x06,0x01,0x00,0xFF,0x00,0x01,0x02,0x02,0x03,0x02,0x02,0xFF,0x01,0x01,0x00,

};
uchar code table2[][16]={
		/*--  文字:  0  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
0x00,0xE0,0x10,0x08,0x08,0x10,0xE0,0x00,0x00,0x0F,0x10,0x20,0x20,0x10,0x0F,0x00,

/*--  文字:  1  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
0x00,0x10,0x10,0xF8,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,

/*--  文字:  2  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
0x00,0x70,0x08,0x08,0x08,0x88,0x70,0x00,0x00,0x30,0x28,0x24,0x22,0x21,0x30,0x00,

/*--  文字:  3  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
0x00,0x30,0x08,0x88,0x88,0x48,0x30,0x00,0x00,0x18,0x20,0x20,0x20,0x11,0x0E,0x00,

/*--  文字:  4  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
0x00,0x00,0xC0,0x20,0x10,0xF8,0x00,0x00,0x00,0x07,0x04,0x24,0x24,0x3F,0x24,0x00,

/*--  文字:  5  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
0x00,0xF8,0x08,0x88,0x88,0x08,0x08,0x00,0x00,0x19,0x21,0x20,0x20,0x11,0x0E,0x00,

/*--  文字:  6  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
0x00,0xE0,0x10,0x88,0x88,0x18,0x00,0x00,0x00,0x0F,0x11,0x20,0x20,0x11,0x0E,0x00,

/*--  文字:  7  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
0x00,0x38,0x08,0x08,0xC8,0x38,0x08,0x00,0x00,0x00,0x00,0x3F,0x00,0x00,0x00,0x00,

/*--  文字:  8  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
0x00,0x70,0x88,0x08,0x08,0x88,0x70,0x00,0x00,0x1C,0x22,0x21,0x21,0x22,0x1C,0x00,

/*--  文字:  9  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
0x00,0xE0,0x10,0x08,0x08,0x10,0xE0,0x00,0x00,0x00,0x31,0x22,0x22,0x11,0x0F,0x00,

/*--  文字:  ：  --*/
/*--  宋体12;  此字体下对应的点阵为：宽x高=8x16   --*/
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x36,0x36,0x00,0x00,0x00,0x00,


};
uchar code table3[][128]={

0xFF,0xFF,0x00,0x00,0x00,0x08,0xFC,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xC0,0xC0,0xCF,0xC8,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,

0xFF,0xFF,0x00,0x00,0x08,0x04,0x04,0x84,0x44,0x38,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xCC,0xCE,0xC9,0xC8,0xC8,0xC8,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,

0xFF,0xFF,0x00,0x00,0x04,0x42,0x42,0x42,0xA4,0x18,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xC4,0xC8,0xC8,0xC8,0xC4,0xC3,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,

0xFF,0xFF,0x00,0x80,0x60,0x18,0x04,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC1,0xC1,0xC1,0xC1,0xCF,0xC1,0xC1,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,
/*--  调入了一幅图像：C:\Documents and Settings\Administrator\My Documents\xxxx.bmp  --*/
/*--  宽度x高度=64x16  --*/
0xFF,0xFF,0x00,0x00,0xFC,0x90,0x90,0x90,0x90,0x10,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xC8,0xD0,0xD0,0xD0,0xC8,0xC7,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,

/*--  调入了一幅图像：C:\Documents and Settings\Administrator\My Documents\xxxx.bmp  --*/
/*--  宽度x高度=64x16  --*/
0xFF,0xFF,0x00,0x00,0xF8,0x84,0x84,0x84,0x84,0x80,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xC7,0xC8,0xC8,0xC8,0xC8,0xC7,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,
/*--  调入了一幅图像：C:\Documents and Settings\Administrator\My Documents\xxxx.bmp  --*/
/*--  宽度x高度=64x16  --*/
0xFF,0xFF,0x00,0x00,0x04,0x04,0x04,0x04,0x04,0xFC,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xCF,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,

0xFF,0xFF,0x00,0x00,0xFE,0x42,0x42,0x42,0x42,0xFE,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xCF,0xC8,0xC8,0xC8,0xC8,0xCF,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,
};
uchar code table4[]={

0xFF,0xFF,0x00,0x00,0x00,0x08,0xFC,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xC0,0xC0,0xCF,0xC8,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,

0xFF,0xFF,0x00,0x00,0x08,0x04,0x04,0x84,0x44,0x38,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xCC,0xCE,0xC9,0xC8,0xC8,0xC8,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,

0xFF,0xFF,0x00,0x00,0x04,0x42,0x42,0x42,0xA4,0x18,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xC4,0xC8,0xC8,0xC8,0xC4,0xC3,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,

0xFF,0xFF,0x00,0x80,0x60,0x18,0x04,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC1,0xC1,0xC1,0xC1,0xCF,0xC1,0xC1,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,
/*--  调入了一幅图像：C:\Documents and Settings\Administrator\My Documents\xxxx.bmp  --*/
/*--  宽度x高度=64x16  --*/
0xFF,0xFF,0x00,0x00,0xFC,0x90,0x90,0x90,0x90,0x10,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xC8,0xD0,0xD0,0xD0,0xC8,0xC7,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,

/*--  调入了一幅图像：C:\Documents and Settings\Administrator\My Documents\xxxx.bmp  --*/
/*--  宽度x高度=64x16  --*/
0xFF,0xFF,0x00,0x00,0xF8,0x84,0x84,0x84,0x84,0x80,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xC7,0xC8,0xC8,0xC8,0xC8,0xC7,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,
/*--  调入了一幅图像：C:\Documents and Settings\Administrator\My Documents\xxxx.bmp  --*/
/*--  宽度x高度=64x16  --*/
0xFF,0xFF,0x00,0x00,0x04,0x04,0x04,0x04,0x04,0xFC,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xCF,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,

0xFF,0xFF,0x00,0x00,0xFE,0x42,0x42,0x42,0x42,0xFE,0x00,0x00,0xFF,0xFF,0x00,0x00,
0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0x00,0x00,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x00,0x00,0x00,0x00,0xFF,0xFF,
0xFF,0xFF,0xC0,0xC0,0xCF,0xC8,0xC8,0xC8,0xC8,0xCF,0xC0,0xC0,0xFF,0xFF,0xC0,0xC0,
0xC3,0xC3,0xC3,0xC3,0xC3,0xC3,0xC0,0xC0,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,
0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xCF,0xC0,0xC0,0xC0,0xC0,0xFF,0xFF,
};
void init()
{
	TMOD=0x01;
	TH0=(65536-1000)/256;
	TL0=(65536-1000)%256;
	EA=1;
	ET0=1;
	TR0=1;
}
uchar ka,key,k_time;
scan_key()//8255键盘的使用
{
	COM=0x80;
	PC=0x0f;
	COM=0x81;
	if((PC&0x0f)!=0x0f)
	{
		k_time++;
		if(k_time==10)
		{
			key=PC&0x0f;
			COM=0x80;
			PC=0xf0;
			COM=0x88;
			key=key|(PC&0xf0);
			switch(key)
			{
				case 0xee: ka=0; break;
				case 0xde: ka=1; break;
				case 0xbe: ka=2; break;
				case 0x7e: ka=3; break;
				case 0xed: ka=4; break;
				case 0xdd: ka=5; break;
				case 0xbd: ka=6; break;
				case 0x7d: ka=7; break;
				case 0xeb: ka=8; break;
				case 0xdb: ka=9; break;
				case 0xbb: ka=10; break;
				case 0x7b: ka=11; break;
				case 0xe7: ka=12; break;
				case 0xd7: ka=13; break;
				case 0xb7: ka=14; break;
				case 0x77: ka=15; break;
				default: break;
			}
		}
	}
	else k_time=0;
}
bujin_init()//步进电机初始化
{
	uint a,i,j;
	a=0;
	dir=1;
	while(a!=1)
	{
		cp=~cp;
		for(j=0;j<100;j++);
		if(rl==1)
		{
			for(j=0;j<100;j++);//调节步进电机，123是010，678是010；
			dir=0;
			for(i=0;i<800;i++)//归零666；
			{
				cp=~cp;
				for(j=0;j<100;j++);//速度100,勿改！！
			}
			a=1;
		}
	}
}
uint jl;
bj()
{
	uint i,j;
			for(i=0;i<jl*685;i++)//归零666；
			{
				cp=~cp;
				for(j=0;j<100;j++);//速度100,勿改！！
			}
}
void write_com(uchar com)
{
	P0=com;
	rs=0;
	en=1,
	en=1;
	en=1;
	en=0;
}
void write_date(uchar date)
{
	P0=date;
	rs=1;
	en=1,
	en=1;
	en=1;
	en=0;
}

void open_on(uchar date)
{
	date|=0x3e;
	write_com(date);
}
void choose_cs(uchar cs)
{
	switch(cs)
	{
		case 0:cs1=1;cs2=1;break;
		case 1:cs1=1;cs2=0;break;
		case 2:cs1=0;cs2=1;break;
		default:break;
	}
}
void set_line(uchar line)
{
	line|=0xc0;
	write_com(line);
}
void ste_hang(uchar hang)
{
	hang|=0xc0;
	write_com(hang);
}
void set_page(uchar page)
{
	page|=0xb8;
	write_com(page);
}
void set_row(uchar row)
{
	row|=0x40;
	write_com(row);
}
void clear_12864(uchar date)
{
	uchar i,k;
	choose_cs(date);
	for (i=0;i<8;i++)
	{
		set_page(i);
		for (k=0;k<64;k++)
		{
			set_row(k);
			write_date(0x00);
		}
	}
}
void init_12864()
{
	open_on(1);
	set_line(0);
	clear_12864(0);
}

hang(uchar page,l)
{
	uint i;
	choose_cs(2);
	set_page(page);
	set_row(64);
	for(i=0;i<64;i++)
	{
		write_date(table3[l][i]);
	}
	set_page(page+1);
	set_row(64);
	for(i=64;i<128;i++)
	{
		write_date(table3[l][i]);
	}
}
gun()
{
	uint h,i,k,n;
	k=1;
	choose_cs(2);
	for(h=0;h<16;h++)
	{
		for(i=n;i<k*16;i++)
		{
			write_com(0xc0+63-i);
			write_com(table4[i]);
		}
		delay(50);
		n=16*k;
		k++;
	}
}
sz(uchar page,row,num)
{
	uchar i;
	if(row>63)
	{
		choose_cs(2);

	}
	else
	{
		choose_cs(1);
	}
	set_page(page);
	set_row(row);
	for(i=0;i<16;i++)
	{
		write_date(table1[num][i]);
	}
	set_page(page+1);
	set_row(row);
	for(i=16;i<32;i++)
	{
		write_date(table1[num][i]);
	}

}
sz1(uchar page,row,num)
{
	uchar i;
	if(row>63)
	{
		choose_cs(2);

	}
	else
	{
		choose_cs(1);
	}
	set_page(page);
	set_row(row);
	for(i=0;i<8;i++)
	{
		write_date(table2[num][i]);
	}
		set_page(page+1);
	set_row(row);
	for(i=8;i<16;i++)
	{
		write_date(table2[num][i]);
	}

}
uint smg;
jxs_csh()
{
	COM=0x92;
	left;
	yigw;
	stop;
	down;
	smg=5;
	xj_jc;
	close;
	jj_jc;
	loose;
	up;
	ss_jc;
	right;
	sangw;
	stop;
	smg=6;
}
qinchu()
{
	while(smg==6)
	{
		scan_key();
		if(ka!=20&smg==6)
		{
			dis_buf[7]=0xff;
			dis_buf[6]=0xff;
			dis_buf[5]=0xff;
			dis_buf[4]=0xff;
			dis_buf[3]=0xff;
			dis_buf[2]=0xff;
			dis_buf[1]=0xff;
			dis_buf[0]=0xff;
			smg=7;
		}
	}
	
}
void lcdx()
{
	
	uint i;
	for(i=0;i<16;i++)
	{
		choose_cs(2);
		write_com(0xc0+63-i);
		delay(50);
	}
}
void lcds()
{
	uint i;
	for(i=0;i<16;i++)
	{
		choose_cs(2);
		write_com(0xc0+i);
		delay(50);
	}
}

uint bh,quanx,wz,zd;
anjian()
{
	P0=0XFF;
	scan_key();
	if(ka==1)
	{
		COM=0x88;
		while(PC!=0xf0);
		ka=20;
		bh++;
		sz1(4,40,bh);
	}
	if(ka==5)
	{
		COM=0x88;
		while(PC!=0xf0);
		ka=20;
		bh--;
		sz1(4,40,bh);
	}
	if(ka==0)
	{
		COM=0x88;
		while(PC!=0xf0);
		ka=20;
		if(wul[bh]==1)
		{
			quanx=1;
		}
		else
		{
			quanx=0;
		}
	}
	if(ka==4)
	{
		COM=0x88;
		while(PC!=0xf0);
		ka=20;
		if(wul[bh]==0)
		{
			quanx=1;
		}
		else
		{
			quanx=0;
		}
	}
	if(quanx==1)
	{
		if(bh>wz)
		{
			zd=bh-wz;
			if(zd>4)
			{
				zd=8-zd;
				while(zd--)
				{
					gun();
				}
				hang(6,bh);
			}
		}
	}
	
}
void main()
{
	init_12864();
	sz(0,0,1);
	sz(0,16,2);
	sz(0,32,3);
	sz(0,48,4);
	sz(2,16,5);
	sz(2,32,6);
	sz(4,0,7);
	sz(4,16,8);
	sz1(4,32,10);
	bh=1;
	wz=1;
	sz(6,0,9);
	sz(6,16,10);
	hang(0,3);
	hang(2,2);
	hang(4,1);
	hang(6,0);
	//sz(6,80,0); 取料后空心方块
	P0=0xff;
	/*jl=1;
	bujin_init();
	bj();
	dir=1;
	bj();
	init();
	jxs_csh();
	P0=0xff;
	ka=20;
	qinchu();
	P0=0xff;
	quanx=2;*/
	while(1)
	{
		scan_key();
		anjian();
	}
}
uint tt,s;
void timer0() interrupt 1
{
	TH0=(65536-1000)/256;
	TL0=(65536-1000)%256;
	wela=0xff;
	dela=0xff;
	dela=dis_buf[index++];
	wela=wei;
	index=index&0x07;
	wei=_crol_(wei,1);
	if(smg==5)
	{
		tt++;
		if(tt==10)
		{
			tt=0;
			s++;
			dis_buf[7]=table[s/100]&0x7f;
			dis_buf[6]=table[s/10%10];
			dis_buf[5]=table[s%10];

		}
	}
}
```

